

char filter_tcl_proc[]=
"#!/usr/bin/wish -f\n"
"\n"
"\n"
"####################################################\n"
"# Note: This dialog makes use of the \"scrollvalue\" #\n"
"# and \"entryvalue\" routines in xvst_plot.tcl       #\n"
"####################################################\n"
"\n"
"# These will be set by C to the appropriate limits\n"
"set cut_high  1.0\n"
"set cut_low   0.0\n"
"set cut_left  0.5\n"
"set cut_right 0.5\n"
"\n"
"set cut_cancel 0\n"
"set cutbutton 0\n"
"\n"
"set tlothi 0\n"
"\n"
"\n"
"#\n"
"# This does the initial setup of the filter box in the\n"
"# \"Fit\" tab. The setup must be completed from C when\n"
"# the names of the Ntuple fields are determined.\n"
"#\n"
"proc init_filter {path} {\n"
"\n"
"   global filter_path\n"
"   global cutbutton\n"
"   global tlothi\n"
"   global smallfont mediumfont largefont hugefont\n"
"   \n"
"   set filter_path $path\n"
"   \n"
"   set w $filter_path\n"
"   label $w.lab -text \"Filter\" -font $mediumfont\n"
"   frame $w.lbf\n"
"   listbox $w.lbf.lb -width 13 -height 7 -font $smallfont \\n"
"      -yscrollcommand {$filter_path.lbf.sb set}\n"
"   # (listbox elements filled from C)\n"
"   scrollbar $w.lbf.sb -command {$filter_path.lbf.lb yview}\n"
"   bind $w.lbf.lb <ButtonRelease> {SetCutButton}\n"
"   pack $w.lbf.lb $w.lbf.sb -side left -fill both\n"
"   checkbutton $w.cut -text \"Cut\" -font $smallfont -variable cutbutton\n"
"   bind $w.cut <ButtonRelease> {SetCuts}\n"
"   pack $w.lab $w.lbf $w.cut -side top -fill both\n"
"\n"
"   checkbutton $w.tlothi -text \"Std. time cut\" -font $smallfont -variable std_tcut -width 15\n"
"   bind $w.tlothi <Double-Button> {Edit_t_limits}\n"
"   pack $w.tlothi -side top -fill both\n"
"\n"
"}\n"
"\n"
"proc SetCutDialog {name upper lower max min} {\n"
"   global cut_upper cut_lower cut_max cut_min cut_cancel\n"
"   \n"
"   set cut_upper $upper\n"
"   set cut_lower $lower\n"
"   set cut_max   $max\n"
"   set cut_min   $min\n"
"\n"
"   toplevel .c\n"
"   wm transient .c .\n"
"   wm title .c \"Set Filter Cut\"\n"
"\n"
"   # this is really used to set the scrollbar width\n"
"   set label_width 40\n"
"\n"
"   # main label\n"
"   label .c.lab -text [format \"Set cut limits for %s\" $name] \\n"
"      -width $label_width -relief groove -borderwidth 2\n"
"   pack .c.lab -side top -ipady 5 -pady 5 -padx 3\n"
"\n"
"   # OK and Cancel buttons\n"
"   frame .c.but\n"
"   button .c.but.ok -text \"OK\" -command {SetCutDialogEnd 0}\n"
"   pack .c.but.ok -side right -fill x\n"
"   button .c.but.cancel -text \"Cancel\" -command {SetCutDialogEnd 1}\n"
"   pack .c.but.cancel -side left -fill x\n"
"   pack .c.but -side bottom -fill x\n"
"\n"
"   # upper\n"
"   frame .c.r\n"
"   label .c.r.lab -text \"upper\" -width $label_width\n"
"   frame .c.r.sbf\n"
"   scrollbar .c.r.sbf.sb -orient horizontal \\n"
"      -command {scrollvalue $cut_min $cut_max .c.r.sbf}\n"
"   entry .c.r.sbf.en -width 8\n"
"   .c.r.sbf.en insert 0 $cut_upper\n"
"   bind .c.r.sbf.en <KeyPress-KP_Enter> {entryvalue $cut_min $cut_max .c.r.sbf}\n"
"   bind .c.r.sbf.en <Return>            {entryvalue $cut_min $cut_max .c.r.sbf}\n"
"   pack .c.r.sbf.en -side right\n"
"   pack .c.r.sbf.sb -side right -fill x -expand 1\n"
"   pack .c.r.lab .c.r.sbf -side top -fill both\n"
"   pack .c.r -side bottom -fill both\n"
"   entryvalue $cut_min $cut_max .c.r.sbf\n"
"\n"
"   # lower\n"
"   frame .c.l\n"
"   label .c.l.lab -text \"lower\" -width $label_width\n"
"   frame .c.l.sbf\n"
"   scrollbar .c.l.sbf.sb -orient horizontal \\n"
"      -command {scrollvalue $cut_min $cut_max .c.l.sbf}\n"
"   entry .c.l.sbf.en -width 8\n"
"   .c.l.sbf.en insert 0 $cut_lower\n"
"   bind .c.l.sbf.en <KeyPress-KP_Enter> {entryvalue $cut_min $cut_max .c.l.sbf}\n"
"   bind .c.l.sbf.en <Return>            {entryvalue $cut_min $cut_max .c.l.sbf}\n"
"   pack .c.l.sbf.en -side right\n"
"   pack .c.l.sbf.sb -side right -fill x -expand 1\n"
"   pack .c.l.lab .c.l.sbf -side top -fill both\n"
"   pack .c.l -side bottom -fill both\n"
"   entryvalue $cut_min $cut_max .c.l.sbf\n"
"   \n"
"	CenterWindow .c\n"
"}\n"
"\n"
"proc SetCutDialogEnd {cancelme} {\n"
"   global cut_upper cut_lower cut_cancel\n"
"   \n"
"   set cut_cancel $cancelme\n"
"   \n"
"   set cut_upper [.c.r.sbf.en get]\n"
"   set cut_lower [.c.l.sbf.en get]\n"
"   \n"
"   if {[expr $cut_cancel==0]} {\n"
"      if {[expr $cut_upper<$cut_lower]} {\n"
"         set msg \"\"\n"
"         set msg [concat $msg \"Your upper cut is less than your lower cut.\"]\n"
"         set msg [concat $msg \"The values for the two will be switched.\"]\n"
"         tk_dialog .c.mess \"Cut values reversed\" $msg \"\" 0 \"OK\"\n"
"\n"
"         set tmp $cut_upper\n"
"         set $cut_upper $cut_lower\n"
"         set $cut_lower $tmp\n"
"      }\n"
"   }\n"
"   \n"
"   destroy .c\n"
"   \n"
"}\n"
"\n"
"\n"
"\n"
"\n"
"proc Edit_t_limits {} {	\n"
"   global t_lo1 t_lo2 t_lo3 t_lo4 t_lo5 t_lo6\n"
"   global t_hi1 t_hi2 t_hi3 t_hi4 t_hi5 t_hi6\n"
"   global autocut_t autocut_t_frac\n"
"   \n"
"   set win .edit_t_limit_win\n"
"   toplevel $win\n"
"   tkwait visibility $win\n"
"   wm title $win \"Edit default limits on t\"\n"
"   \n"
"   ####### OK, Cancel buttons #########\n"
"   frame $win.but\n"
"   button $win.but.ok -text \"OK\" -width 6 -command { \\n"
"      for {set super 1} {[expr $super<=6]} {incr super} {\\n"
"         set win2 .edit_t_limit_win.sl$super ;\\n"
"         set t_lo$super [$win2.lo get] ;\\n"
"         set t_hi$super [$win2.hi get] ;\\n"
"      } ;\\n"
"      if {[expr $autocut_t!=0]} then {\\n"
"         set autocut_t_frac [.edit_t_limit_win.autofind.en get] \\n"
"      };\\n"
"      destroy .edit_t_limit_win ;\\n"
"   }\n"
"   pack $win.but.ok -side right\n"
"   button $win.but.cancel -text \"Cancel\" -width 6 \\n"
"   	-command {destroy .edit_t_limit_win}\n"
"   pack $win.but.cancel -side left\n"
"   pack $win.but -side bottom -fill x\n"
"   \n"
"   ####### autofind #######\n"
"   set win2 $win.autofind\n"
"   frame $win2\n"
"   checkbutton $win2.autofind -variable autocut_t -text \"autofind\" \\n"
"      -command {Set_t_limit_state}\n"
"   entry $win2.en -width 6\n"
"   $win2.en insert 0 $autocut_t_frac\n"
"\n"
"   pack $win2.autofind $win2.en -side left\n"
"   pack $win2 -side bottom\n"
"\n"
"   ####### limit entries ######\n"
"   frame $win.lab\n"
"   label $win.lab.lab1 -text \"Layer\" -width 5\n"
"   label $win.lab.lab2 -text \"t_lo\" -width 10 -borderwidth 2 -relief groove\n"
"   label $win.lab.lab3 -text \"t_hi\" -width 10 -borderwidth 2 -relief groove\n"
"   pack $win.lab.lab1 $win.lab.lab2 $win.lab.lab3 -side left\n"
"   pack $win.lab -side top\n"
"   \n"
"   for {set super 1} {[expr $super<=6]} {incr super} {\n"
"      \n"
"      set win2 $win.sl$super\n"
"      frame $win2\n"
"      label $win2.lab -text SL$super -width 5\n"
"      entry $win2.lo -width 10\n"
"      entry $win2.hi -width 10\n"
"      pack $win2.lab $win2.lo $win2.hi -side left\n"
"      pack $win2 -side top\n"
"      \n"
"      $win2.lo insert 0 [set t_lo$super]\n"
"      $win2.hi insert 0 [set t_hi$super]\n"
"   }\n"
"      \n"
"   Set_t_limit_state\n"
"   CenterWindow .edit_t_limit_win\n"
"   tkwait window .edit_t_limit_win\n"
"}\n"
"\n"
"proc Set_t_limit_state {} {	\n"
"   global autocut_t autocut_t_frac\n"
"\n"
"   set win .edit_t_limit_win\n"
"   set win2 $win.autofind\n"
"   if {[expr $autocut_t==0]} then {\n"
"      $win2.en configure -state disabled -fg \"#777\"\n"
"      set color \"#000\"\n"
"      set en_state normal\n"
"   } else {\n"
"      $win2.en configure -state normal -fg \"#000\"\n"
"      focus $win2.en\n"
"      set color \"#777\"\n"
"      set en_state disabled\n"
"   }\n"
"   \n"
"   $win.lab.lab1 configure -foreground $color\n"
"   $win.lab.lab2 configure -foreground $color\n"
"   $win.lab.lab3 configure -foreground $color\n"
"   for {set super 1} {[expr $super<=6]} {incr super} { \n"
"      $win.sl$super.lab configure -foreground $color \n"
"      $win.sl$super.lo configure -state $en_state -fg $color\n"
"      $win.sl$super.hi configure -state $en_state -fg $color\n"
"   }\n"
"\n"
"}\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"
"\n"

;

